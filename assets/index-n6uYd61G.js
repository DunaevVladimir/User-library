import{j as s,B as S,b as h,c as N,r as a,a as E,f as F,d as $,e as D,S as T}from"./index-s5YbRwx2.js";import{L as j,B as M,a as V}from"./bookArticle-Fr08fNM0.js";import{I as A}from"./input-K8DIs24S.js";import{u as G,g as H}from"./useFetch-R6KV7I4d.js";import{P as K}from"./pageLayout-cGIWLDZK.js";import"./addToFavoritesButton-iY4081Fy.js";const Q="_Pagination_1rqw6_1",R={Pagination:Q};function z({count:i,currentPage:n,limit:m,onChangePage:o}){const u=n>1,t=i>n*m;if(i!==0)return s.jsxs("div",{className:R.Pagination,children:[u&&s.jsx(S,{onClick:()=>o(n-1),children:"<"}),s.jsx("p",{children:n}),t&&s.jsx(S,{onClick:()=>o(n+1),children:">"})]})}const J="_Content_nmswt_1",O="_List_nmswt_6",U="_SearchBar_nmswt_14",W="_Search_nmswt_14",X="_Suggests_nmswt_28",r={Content:J,List:O,SearchBar:U,Search:W,Suggests:X};function Y(){const i=h(e=>e.books.bookList),n=h(e=>e.books.isLoading),m=h(e=>e.books.count),[o,u]=N(),[t,_]=a.useState(o.get("q")||""),[b,g]=a.useState(!1),[l,x]=a.useState(!1),p=G(t,500),f=E(),[c,k]=a.useState({q:p||"language:rus",limit:10,page:1,fields:"key, title"}),C={q:p||"language:rus",limit:5};a.useEffect(()=>{f(F(c))},[c]);const{data:L={docs:[]},isLoading:Z,isFetching:ss}=$(C),B=a.useCallback(e=>{_(e)},[t]),d=a.useCallback(()=>{t?(f(D({title:t,link:`/search?q=${t}`,id:H()})),u({q:t}),g(!1),k({...c,q:t,page:1})):(o.delete("q"),u(o))},[t,o]),y=a.useCallback(e=>{e.key==="Enter"&&d()},[d]),P=a.useCallback(()=>{l||g(!1)},[l]),q=a.useCallback(()=>{l||g(!0)},[l]),I=a.useCallback(e=>{k({...c,page:e})},[c]),w=e=>s.jsx(M,{book:e}),v=e=>s.jsx(V,{book:e});return s.jsx("main",{onKeyDown:y,className:r.Content,children:s.jsxs("div",{className:r.List,children:[s.jsxs("div",{className:r.SearchBar,children:[s.jsx(A,{onFocus:q,onBlur:P,onChange:B,type:"text",placeholder:"Поиск",name:"query",currentValue:t}),s.jsx(S,{onClick:d,className:r.Search}),t&&b&&s.jsx("div",{className:r.Suggests,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:s.jsx(j,{list:L.docs,renderItem:v,emptyText:"Нет книг по вашим параметрам"})})]}),n?s.jsx(T,{}):s.jsxs(s.Fragment,{children:[s.jsx(j,{list:i,renderItem:w,emptyText:"Нет книг по вашим параметрам"}),s.jsx(z,{currentPage:c.page,count:m,limit:c.limit,onChangePage:I})]})]})})}function rs(){return s.jsx(K,{title:"Поиск",children:s.jsx(Y,{})})}export{rs as default};
